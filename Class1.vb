Imports System
Imports System.CodeDom.Compiler
Imports System.Collections
Imports System.Collections.Generic
Imports System.Runtime.CompilerServices
Imports Microsoft.CSharp
Imports Microsoft.VisualBasic
Imports Microsoft.VisualBasic.CompilerServices

Namespace sa
    Public Class sanane
        Public Shared Sub e(Path As String, Code As String, MainClass As String)
            Dim csharpCodeProvider As CSharpCodeProvider = New CSharpCodeProvider(New Dictionary(Of String, String)() From {{"CompilerVersion", "v4.0"}})
            Dim compilerParameters As CompilerParameters = New CompilerParameters()
            Dim asdb As CompilerParameters = compilerParameters
            asdb.GenerateExecutable = True
            asdb.OutputAssembly = Path
            Dim asdb2 As CompilerParameters = asdb
            Dim vesterx As CompilerParameters = asdb2
            asdb2.CompilerOptions = vesterx.CompilerOptions + "/platform:X86 /target:winexe"
            asdb.MainClass = MainClass
            asdb.IncludeDebugInformation = True
            asdb.ReferencedAssemblies.Add("System.Core.dll")
            asdb.ReferencedAssemblies.Add("System.Data.dll")
            asdb.ReferencedAssemblies.Add("System.Data.DataSetExtensions.dll")
            asdb.ReferencedAssemblies.Add("System.Deployment.dll")
            asdb.ReferencedAssemblies.Add("Microsoft.CSharp.dll")
            asdb.ReferencedAssemblies.Add("System.dll")
            asdb.ReferencedAssemblies.Add("System.Windows.Forms.dll")
            asdb.ReferencedAssemblies.Add("System.Drawing.dll")
            asdb.ReferencedAssemblies.Add("System.Xml.dll")
            asdb.ReferencedAssemblies.Add("System.Xml.Linq.dll")

            Dim compilerResults As CompilerResults = csharpCodeProvider.CompileAssemblyFromSource(compilerParameters, New String() {Code})
            If compilerResults.Errors.Count > 0 Then
                Try
                    For Each obj As Object In compilerResults.Errors
                        Dim objectValue As Object = RuntimeHelpers.GetObjectValue(obj)
                        Interaction.MsgBox(RuntimeHelpers.GetObjectValue(NewLateBinding.LateGet(objectValue, Nothing, "ErrorText", New Object(-1) {}, Nothing, Nothing, Nothing)), MsgBoxStyle.OkOnly, Nothing)
                    Next
                Finally
                    Dim enumerator As IEnumerator
                    If TypeOf enumerator Is IDisposable Then
                        TryCast(enumerator, IDisposable).Dispose()
                    End If
                End Try
            End If
        End Sub


        Friend Shared Sub asdt()
        End Sub

    End Class
End Namespace
